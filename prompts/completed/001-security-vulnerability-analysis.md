<objective>
Perform a comprehensive security vulnerability analysis of the entire codebase.
Identify security weaknesses across all categories to protect the application from potential attacks.
</objective>

<context>
Read @CLAUDE.md first to understand the project structure and conventions.
This is a security audit to identify vulnerabilities before they can be exploited.
</context>

<analysis_scope>
Thoroughly analyze all source code files for security vulnerabilities.
Focus areas:
- `src/` - All application source code
- `config/` - Configuration files
- `templates/` - Script templates
- Any files handling user input, authentication, or data processing
</analysis_scope>

<vulnerability_categories>
Check for ALL of the following:

**OWASP Top 10:**
- Injection (SQL, command, code injection)
- Broken authentication/session management
- Sensitive data exposure
- XML external entities (XXE)
- Broken access control
- Security misconfiguration
- Cross-site scripting (XSS)
- Insecure deserialization
- Using components with known vulnerabilities
- Insufficient logging/monitoring

**Additional Categories:**
- Path traversal vulnerabilities
- Hardcoded secrets/credentials
- Insecure cryptographic practices
- Race conditions
- Input validation gaps
- Unsafe file operations
- Privilege escalation vectors
- Business logic flaws
- Denial of service vectors
- Information leakage
</vulnerability_categories>

<analysis_requirements>
For each vulnerability found, capture:
1. **File:Line** - Exact location
2. **Severity** - Critical/High/Medium/Low
3. **Type** - Vulnerability category
4. **Issue** - Brief description (1-2 sentences)
5. **Fix** - Remediation suggestion (1 sentence)
</analysis_requirements>

<output_format>
Create a summary table organized by severity:

```
## Security Analysis Summary

### Critical
| Location | Type | Issue | Fix |
|----------|------|-------|-----|
| file:line | category | description | suggestion |

### High
| Location | Type | Issue | Fix |
|----------|------|-------|-----|

### Medium
| Location | Type | Issue | Fix |
|----------|------|-------|-----|

### Low
| Location | Type | Issue | Fix |
|----------|------|-------|-----|

## Statistics
- Critical: X
- High: X
- Medium: X
- Low: X
- Total: X
```

Save analysis to: `./analyses/security-audit.md`
</output_format>

<verification>
Before completing:
- Confirm all src/ files were analyzed
- Verify each finding has all 5 required fields
- Check that severity ratings are consistent
</verification>

<success_criteria>
- All source files analyzed
- Findings organized by severity
- Each vulnerability has location, type, description, and fix
- Summary statistics provided
- Report saved to ./analyses/security-audit.md
</success_criteria>
